// need to rewrite in Kotlin